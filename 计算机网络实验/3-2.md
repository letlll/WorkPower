# 第三章 实验（二）常用网络命令与Cisco_Packet_Tracer 环境熟悉

## 3.1 常用网络命令的使用

### 3.1.1 实验目的

理解、验证常用网络命令的原理和功能，掌握常用的网络命令使用方法，合理使用相关命令对网络进行管理与维护

### 3.1.2 实验内容

q  网络参数查询命令：IPCONFIG 和 IP 地址相关计算

q  网络测试命令：PING 命令，用于网络质量定性分析和网络故障检测

q  路由表命令 ROUTE

q  网络端口查询命令：NETSTAT

q  以太网络 ARP 表命令

3.1.3 实验环境

Windows Server 2008 操作系统，或其他 Windows 环境。

### 3.1.4实验步骤

3.1.4.1 IPCONFIG

ipconfig 实用程序可用于显示当前的tcp/ip配置的设置值。这些信息一般用来检验人工配置的tcp/ip设置是否正确。但是，如果你的计算机和所在的局域网使用了动态主机配置协议（Dynamic Host Configuration Protocol，DHCP），这个程序所显示的信息也许更加实用。这时，ipconfig可以让你了解你的计算机是否成功的租用到一个ip地址，如果租用到则可以了解它目前分配到的是什么地址。了解计算机当前的ip地址、子网掩码和缺省网关实际上是进行测试和故障分析的必要项目。 

最常用的选项：

ipconfig——当使用ipconfig时不带任何参数选项，那么它为每个已经配置了的接口显示ip地址、子网掩码和缺省网关值。 

ipconfig /all——当使用all 选项时，ipconfig能为dns 和wins 服务器显示它已配置且所要使用的附加信息（如ip地址等），并且显示内置于本地网卡中的物理地址（mac）。如果ip地址是从dhcp服务器租用的，ipconfig将显示dhcp服务器的ip地址和租用地址预计失效的日期（有关dhcp服务器的相关内容请详见其他有关nt服务器的书籍或询问你的网管）。 

ipconfig /release和ipconfig /renew——这是两个附加选项，只能在向dhcp服务器租用其ip 地址的计算机上起作用。如果你输入ipconfig /release，那么所有接口的租用 ip 地址便重新交付给dhcp 服务器（归还ip 地址）。如果你输入ipconfig /renew，那么本地计算机便设法与dhcp服务器取得联系，并租用一个ip地址。请注意，大多数情况下网卡将被重新赋予和以前所赋予的相同的ip地址。

如运行IPCONFIG.EXE则运行结果如下:

Windows IP Configuration 

Ethernet adapter 本地连接: 

Connection-specific DNS Suffix  . :

IP Address. . . . . . . . . . . . : 168.168.120.66

Subnet Mask . . . . . . . . . . . : 255.255.255.0

Default Gateway . . . . . . . . . : 168.168.120.250 实验：切换到命令窗口状态输入 Ipconfig/all

3.1.4.2 ping命令 

ping 是个使用频率极高的实用程序，用于确定本地主机是否能与另一台主机交换（发送与接收）数据报。根据返回的信息，你就可以推断tcp/ip参数是否设置得正确以及运行是否正常。需要注意的是：成功地与另一台主机进行一次或两次数据报交换并不表示tcp/ip 配置就是正确的，你必须执行大量的本地主机与远程主机的数据报交换，才能确信tcp/ip 的正确性。 

简单的说，ping就是一个测试程序，如果ping运行正确，你大体上就可以排除网络访问层、网卡、modem的输入输出线路、电缆和路由器等存在的故障，从而减小了问题的范围。但由于可以自定义所发数据报的大小及无休止的高速发送，ping 也被某些别有用心的人作为ddos（拒绝服务攻击）的工具，yahoo曾经被黑客利用数百台可以高速接入互联网的

电脑连续发送大量ping 数据报而瘫痪。 按照缺省设置，windows上运行的ping命令发送4 个icmp（网间控制报文协议）回送请求，每个32字节数据，如果一切正常，你应能得到4 个回送应答。ping能够以毫秒为单位显示发送回送请求到返回回送应答之间的时间量。如果应答时间短，表示数据报不必通过太多的路由器或网络连接速度比较快。ping还能显示 ttl（time to live存在时间）值，你可以通过ttl值推算一下数据包已经通过了多少个路由器：源地点ttl起始值（就是比返回ttl略大的一个2的乘方数）-返回时ttl值。例如，返回ttl值为119，那么可以推算数据报离开源地址的ttl起始值为128，而源地点到目标地点要通过9个路由器网段（128-119）；如果返回ttl值为247，ttl起始值就是256，源地点到目标地点要通过9个路由器网段。  

通过ping检测网络故障的典型次序。正常情况下，当你使用ping命令来查找问题所在或检验网络运行情况时，你需要使用许多ping命令，如果所有都运行正确，你就可以相信基本的连通性和配置参数没有问题；如果某些ping命令出现运行故障，它也可以指明到何处去查找问题。下面就给出一个典型的检测次序及对应的可能故障： 

ping 127.0.0.1——这个ping命令被送到本地计算机的ip软件，该命令永不退出该计算机。如果没有做到这一点，就表示tcp/ip的安装或运行存在某些最基本的问题。 

ping 本机ip——这个命令被送到你计算机所配置的ip 地址，你的计算机始终都应该对该ping命令作出应答，如果没有，则表示本地配置或安装存在问题。出现此问题时，局域网用户请断开网络电缆，然后重新发送该命令。如果网线断开后本命令正确，则表示另一台计算机可能配置了相同的ip地址。  

ping 局域网内其他ip——这个命令应该离开你的计算机，经过网卡及网络电缆到达其他计算机，再返回。收到回送应答表明本地网络中的网卡和载体运行正确。但如果收到0个回送应答，那么表示子网掩码（进行子网分割时，将ip地址的网络部分与主机部分分开的代码）不正确或网卡配置错误或电缆系统有问题。 

ping 网关ip——这个命令如果应答正确，表示局域网中的网关路由器正在运行并能够作出应答。 

ping 远程ip——如果收到4 个应答，表示成功的使用了缺省网关。对于拨号上网用户则表示能够成功的访问internet（但不排除isp的dns会有问题）。 

ping localhost——localhost是个作系统的网络保留名，它是127.0.0.1的别名，每太计算机都应该能够将该名字转换成该地址。如果没有做到这一带内，则表示主机文件

（/windows/host）中存在问题。  

ping http://www.yahoo.com/——对这个域名...是通过dns 服务器如果这里出现故

障，则表示dns服务器的ip地址配置不正确或dns服务器有故障（对于拨号上网用户，某些isp 已经不需要设置dns 服务器了）。顺便说一句：你也可以利用该命令实现域名对ip地址的转换功能。 

如果上面所列出的所有ping命令都能正常运行，那么你对你的计算机进行本地和远程通信的功能基本上就可以放心了。但是，这些命令的成功并不表示你所有的网络配置都没有问题，例如，某些子网掩码错误就可能无法用这些方法检测到。下面出示ping命令及其输出的例子： 

C:\WINIDOWS>ping 198.87.118.1

Pinging 198.98.118.1 whit 32 bytes of data：

Reply from 198.98.118.1：bytes=32 time=224ms TTL=14 Reply from 198.98.118.1：bytes=32 time=213ms TTl=14 Reply from 198.98.118.1：bytes=32 time=213ms TTl=14 Reply from 198.98.118.1：bytes=32 time=213ms TTl=14

除了帮助判断伺时一台主机不能达到和测试路由器及其他主机的连接外，ping还可测试路由问题。当使用一台主机时，如果用ping获取它的IP地址，但Ping未能到达该主机时，那么该主机可能没有列在DNS服务器或是本地的Hosts文件中，或是指定的是一个无效的DNS服务器或该DNS服务器是不可到达的。这时可以通过向Hosts文件中输入远程主机的名字和IP 地址(正在ping的那台主机)来缓解这个问题。 

在开始用ping工具进行远程主机连接或路由问题解决之前，应该首先用ping测试计算机来验证它的网络接口正在正确工作。要测试自己的机器，可使用下面命令的任意一个(用你的计算机的实际IP地址代替yourIPaddress)： ping locatlhost ping 127.0.0.1

ping yourIPaddress 提示:可通过使用带有—r参数的ping命令判断到远程主机的包所选择的路由。 

下面是ping命令的语法： 

ping[-t][-a][-n count][-l length][-f][-ittl][-vtos][-rcount][-scount][[-j host-list]]|[-k

host-list)[-w timeout]destination-list ping命令可用的参数说明如下： 

-t。引导ping继续测试远程主机直到按Ctrl+C中断该命令。

-a。使ping命令不要把IP地址分解成host主机名，这对解决DNS和Hosts文件问题是有用的。

-n count。缺省情况下，ping发送四个ICMP包到远程主机，可以使用-n参数指定被发送的包的数目。

-l length。使用-l参数指定ping传送到远程主机的ICMP包的长度。缺省情况下，ping 发送长度为64bytes的包，但是可指定最大字节数为8192bytes。

-f。使ping 命令在每个包中都包含一个Do Not Fragment(不分段)的标志，它禁止包

(packet)经过的网关把packet分段。

-i ttl。设定Time To Live(存活时间)。用ttl 指定其值。

-v tos。设置Type Of Service(服务类型)，其值由toS 指定。

-r      count。记录发出的packet 和返回的packet 的路由，必须使用count 的值指定l到9 个主机。

-s      count。由count 指定的段的数目指定时间标记(timestamp)。

-j      host-list。使用户能够使用路由表说明packet 的路径，可以使用中间网关分隔连续的主机。IP支持的最大主机的数目是9个。

-k      host-Iist。使用户通过由host-list 指定的路由列表说明packet 的路由，可通过中间网关分隔连续的主机，IP支持的最大主机的数目是9个。

-w timeout。为包的传输以毫秒为单位指定超时时间。

destination-list。指定ping的主机。

实验：切换到命令窗口状态输入 ping locatlhost 

ping 127.0.0.1 

ping 目的主机的IP地址

3.1.4.3 ROUTE

大多数主机一般都是驻留在只连接一台路由器的网段上。由于只有一台路由器，因此不存在使用哪一台路由器将数据报发表到远程计算机上去的问题，该路由器的ip地址可作为该网段上所有计算机的缺省网关来输入。 

但是，当网络上拥有两个或多个路由器时，你就不一定想只依赖缺省网关了。实际上你可能想让你的某些远程ip地址通过某个特定的路由器来传递，而其他的远程ip则通过另一个路由器来传递。 

在这种情况下，你需要相应的路由信息，这些信息储存在路由表中，每个主机和每个路由器都配有自己独一无二的路由表。大多数路由器使用专门的路由协议来交换和动态更新路由器之间的路由表。但在有些情况下，必须人工将项目添加到路由器和主机上的路由表中。route就是用来显示、人工添加和修改路由表项目的。  

一般使用选项： 

route print——本命令用于显示路由表中的当前项目，由于用ip地址配置了网卡，因此所有的这些项目都是自动添加的。 

route add——使用本命令，可以将信路由项目添加给路由表。例如，如果要设定一个到目的网络209.98.32.33的路由，其间要经过5个路由器网段，首先要经过本地网络上的一

个路由器，器ip为202.96.123.5，子网掩码为255.255.255.224，那么你应该输入以下命令：  route add 209.98.32.33 mask 255.255.255.224 202.96.123.5 metric 5  

route change——你可以使用本命令来修改数据的传输路由，不过，你不能使用本命令来改变数据的目的地。下面这个例子可以将数据的路由改到另一个路由器，它采用一条包含3个网段的更直的路径： 

route add 209.98.32.33 mask 255.255.255.224 202.96.123.250 metric 3 route delete——使用本命令可以从路由表中删除路由。例如：route delete 209.98.32.33 

实验：切换到命令窗口状态输入 

Route print 

3.1.4.4 netstat 

netstat实用程序是一个诊断工具，可以使用它监视到远程主机的连接以及该连接的协议统计。netstat实用程序对从使用域名连接到的主机中提取IP地址也是有用的。netstat 命令的语法如下： 

netstat [-a][-ens][-p protocol][-r][interval]  下面列出丁netstat命令中可使用的参数： 

-a。使netstat显示所有连接，正常情况下，netstat不显示服务器的连接。 

-e。使netstat显示Enhernet的统计。—e参数可与—s参数联合使用(在后面解释)。

-n。使netstat用数字格式显示地址和端口号而不是用host.domain格式列出名字。 

-s。使用netstat显示基于每个协议的统计。缺省情况，nestat显示TCP，UDP，ICMP 和IP协议的统计。 

-p protocol。显示由protocol 参数指定的协议连接。 

-r。使netstat显示路由表的内容。interval。可指定一个间隔，单位为秒。在该间隔 netstat 显示请求的信息，要中断netstat的输出，按Ctrl+C。如果不包括interval的值，则netstat仅显示一次请求的数据，然后中断。 

提示：如果想获取所连接的主机IP地址，可使用带—n参数的netstat命令。下面 的例子使用没有任何参数的netstat来显示连接的主机，然后又发出带-n参数的netstat来驱动

该IP 地址，可从第二次输出中分辨出Microsoft ftp 服务器的IP 地址是198.105.Z32.1。 

C：\WINDOWS>netstat Active Connections Proto Local Address  Foreign Address 

State 

|   |   |   |   |   |
|---|---|---|---|---|
|TCP|tower：1283|ftp．microsoft.COm:ftp|   |ESTABLISHED|
|C:\WiNDOWS>netstat -n|   |   |||
|Active Connections|   |   |||
|Proto Local Address|   |   |Foreign Address|State|
|TCP|189.87.118.72：1283|   |198.105.232.1:2l|ESTABLISHED|
||||||

除了使用netstat从host。domain名字中查找到IP地址外，也可从一个主机的1P地址查找到它的host．domain名字。 

经常上网的人一般都使用icq的，不知道你有没有被一些讨厌的人骚扰得不敢上线，想投诉却又不知从和下手？其实，你只要知道对方的ip，就可以向他所属的isp投诉了。但怎样才能通过icq知道对方的ip呢？如果对方在设置icq时选择了不显示ip地址，那你是无法在信息栏中看到的。其实，你只需要通过netstat就可以很方便的做到这一点：当他通过icq 或其他的工具与你相连时（例如你给他发一条icq信息或他给你发一条信息），你立刻在dos prompt下输入netstat -n或netstat -a 就可以看到对方上网时所用的ip或isp域名了，甚

至连所用port都完全暴露了。 

实验：切换到命令窗口状态输入 

Netstat **–**a

Netstat **–**ens

Netstat -r 

3.1.4.5以太网络 **ARP** 表命令

1. ARP命令

通过arp命令可以查看ARP高速缓存中的内容，可以清除缓存中的地址映射，建立新的地址映射常用命令选项：

Ø  arp -a或arp -g--用于查看高速缓存中的所有项目。-a和-g参数的结果是一样的，多年来-g一直是UNIX平台上用来显示ARP高速缓存中所有项目的选项，而 Windows 用的是arp -a（-a可被视为all，即全部的意思），但它也可以接受比较传统的-g 选项。

Ø  arp -a IP--如果你有多个网卡，那么使用arp -a加上接口的IP地址，就可以只显示与该接口相关的ARP缓存项目。

Ø  arp -s IP 物理地址——你可以向ARP高速缓存中人工输入一个静态项目。该项目在计算机引导过程中将保持有效状态，或者在出现错误时，人工配置的物理地址将自动更新该项目。

Ø  arp -d IP--使用本命令能够人工删除一个静态项目。

实验：切换到命令窗口状态输入  arp **–**a

## 3.2 Cisco_Packet_Tracer使用简介

3.2.1 实验目的

了解 Cisco_Packet_Tracer 环境，熟悉其中的常见操作。

### 3.2.2 实验内容

1.       启动运行并了解 Cisco_Packet_Tracer 环境；

2.       利用 Cisco_Packet_Tracer 搭建一个简单的网络。

### 3.2.3 Cisco_Packet_Tracer使用简介

Cisco_Packet_Tracer 主界面如图 3.1 所示。

![](assets/Pasted%20image%2020241023091325.png))

图 3.1 Cisco_Packet_Tracer 主界面其中：

1）   最上面的还是和一些其他的软件一样，新建，打开，保存、复制、粘贴、Undo、Redo 等之类的编辑操作。

2）   中间的白框是工作区域，在此构建你所需要的网络拓扑结构。也可以点击其中的每个网络设备（例如交换机或路由器）以及终端计算机等，系统将会弹出该设备对应的设置对话框对该设备进行相关设置。

3）   界面右边是圈划设备，移动设备，删除设备之类的操作的设备编辑区。

4）   左下面是系统提供的各种网络设备和终端构件，包括路由器、交换机、集线器、无线设备、连线、终端设备（例如计算机）等类型，即设备类别选择区。选中其中一类后在设备列表区将列出该类别设备的所有设备。可以用鼠标将设备列表区中的设备拖拉到工作区中构建自己的网络拓扑。

注意：在这里，强调一下连线的问题，这里面的线分为直连线，交叉线，级连线，DCE

和 DTE 线等，连接不同的设备请选用合适的线，否则，通信不了是很正常的。虽然还有个

AUTO（自动选择线），但是，最好别用这个，软件没人聪明。

### 3.2.4实验内容与步骤

内容：建立一个简单的网络，两台 PC 和一台交换机 2950-24，配置两台 PC 的 IP 信息，测试 PC 之间是否能 Ping 通，在此基础上熟悉 Cisco_Packet_Tracer 环境的使用。

步骤：

（1）   添加交换机 2950-24。

（2）   添加 PC，命名为 PC_1，并将其 IP 设置为 192.168.1.1。

（3）   添加 PC，命名为 PC_2，并将其 IP 设置为 192.168.1.2。

（4）   测试 PC_1 与 PC_2 之间的连通性，在 PC 的桌面命令窗口实现测试。


![](assets/屏幕截图%202024-10-23%20091256.png)
![](assets/屏幕截图%202024-10-23%20091304.png)
